\documentclass[10pt,a4paper]{article}

\usepackage{euler}
\usepackage[cm-default]{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}
\usepackage{ifpdf}
\usepackage[utf8]{inputenc}
\usepackage[UKenglish]{babel}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage[breaklinks=true,colorlinks=true,linkcolor=MidnightBlue,urlcolor=OliveGreen]{hyperref}
\usepackage{listings}
\usepackage[a4paper]{geometry}
\usepackage{textcomp}
\usepackage{setspace}
\usepackage{amsmath}

\usepackage{tikz}
\usetikzlibrary{trees,chains,backgrounds,fit,calc,shapes.multipart}

\tikzset{
  generic node/.style={
    rectangle,rounded corners=2mm,
    very thick,
    text height=1.5ex,text depth=.25ex,
    align=center,
    text=black
  },
  grey node/.style={
    generic node,
    draw=black!50,
    top color=white,bottom color=black!20
  },
  red node/.style={
    generic node,
    draw=red!50!black!50,
    top color=white,bottom color=red!50!black!20
  },
  blue node/.style={
    generic node,
    draw=MidnightBlue!50!black!50,
    top color=white,bottom color=MidnightBlue!50!black!20
  },
  green node/.style={
    generic node,
    draw=OliveGreen!50!black!50,
    top color=white,bottom color=OliveGreen!50!black!20
  },
  object/.style={blue node,font=\ttfamily},
  class/.style={grey node,font=\ttfamily},
  sclass/.style={red node,font=\ttfamily},
  module/.style={green node,font=\ttfamily},
  multiline node/.style={
    text height=,text depth=
  },
  line/.style={
    thick,
    draw=black!50,
    color=black!50,
    text=black!70
  },
  every edge/.style={line},
  every path/.style={line,rounded corners},
  >=stealth,
  background/.style={
    fill=black!5,rounded corners
  },
  diagram transition/.style={
    ->,shorten >=1mm,shorten <=1mm,
    dashed,
    every node/.style={
      above,align=center,
      midway,text width=1.5cm,
      font=\normalfont,
      text=black
    }
  }
}

\definecolor{verylightgrey}{gray}{0.95}
\definecolor{lightgrey}{gray}{0.85}

\lstset{
  language=Ruby,                % choose the language of the code
  showstringspaces=false,       % underline spaces within strings
  tabsize=2,	                  % sets default tabsize to 2 spaces
  rulesepcolor=\color{Gray},
  basicstyle={\ttfamily \small},
  upquote=true,
  keywordstyle=\color{Mahogany}\bfseries,
  commentstyle=\color{MidnightBlue}\em,
  stringstyle=\color{RedOrange},
  aboveskip=\bigskipamount,
  belowskip=0pt,
  backgroundcolor=\color{verylightgrey},
  frame=single,
  frameround=tttt,
  rulecolor=\color{lightgrey}
}
\lstdefinelanguage{treetop}
{keywords={rule,end},string=[b]{'}}

\setmainfont[Mapping=tex-text-with-ligs]{GaramondClassico}
\newfontface\GaramondClassicoSC{GaramondClassicoSC}

\onehalfspace
\pagestyle{headings}

\numberwithin{figure}{section}

\def\gettitle{Carat: An interpreter written in Ruby}
\def\getauthor{Jonathan Leighton}
\def\getdate{\today}

\title{\gettitle}
\author{\getauthor}
\date{\getdate}

\hypersetup{
  pdftitle=\gettitle,
  pdfsubject=\gettitle,
  pdfauthor=\getauthor,
  pdfcreationdate=\getdate
}

% Use the url package to define a command for typesetting inline code
\DeclareUrlCommand\code{\def\UrlFont{\ttfamily \color{Mahogany}}}

% \url commands don't work in "moving arguments" (captions, sections, etc), so this is a fallback
% command which doesn't allow handle line breaks (but that shouldn't be a problem in these cases)
\newcommand{\movingcode}[1]{\texttt{\textcolor{Mahogany}{#1}}}

\newcommand{\defn}[1]{\emph{{#1}}}

\newenvironment{dirlist}{
  \begin{itemize}
  \setlength{\itemsep}{0pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
  \renewcommand{\labelitemi}{}
  \renewcommand{\labelitemii}{}
  \renewcommand{\labelitemiii}{}
  \renewcommand{\labelitemiv}{}
}{
  \end{itemize}
}

\begin{document}
  \include{titlepage}
	
	\tableofcontents
	
	\setlength{\parindent}{0pt}
  \setlength{\parskip}{2ex}
	
	\include{introduction}
	\include{implementation}
	\include{implementation_specifics}
	\include{testing}
	\include{conclusions}
	\include{references}
	
	\appendix
	\include{classes_index}
	\include{language_overview}
\end{document}

